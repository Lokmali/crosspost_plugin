(self.webpackChunkcrosspost_plugin=self.webpackChunkcrosspost_plugin||[]).push([["src_index_ts"],{9223:function(t,e,r){"use strict";r.r(e),r.d(e,{CrosspostPluginClient:function(){return h}});var n=r("7233");function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e,r,n,a,o,s){try{var i=t[o](s),u=i.value}catch(t){r(t);return}i.done?e(u):Promise.resolve(u).then(n,a)}function s(t){return function(){var e=this,r=arguments;return new Promise(function(n,a){var s=t.apply(e,r);function i(t){o(s,n,a,i,u,"next",t)}function u(t){o(s,n,a,i,u,"throw",t)}i(void 0)})}}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function l(t,e){var r,n,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}var h=function(){var t,e,r;function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://api.opencrosspost.com/",e=this;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,o),u(this,"client",void 0),u(this,"authConfig",null),u(this,"accountId",void 0);var r="string"==typeof t?{baseUrl:t,accountId:""}:t;this.accountId=r.accountId,this.client=n.default.create({baseURL:r.baseUrl,timeout:r.timeout||3e4,headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(function(t){if("get"===t.method&&(t.headers["X-Near-Account"]=e.accountId),"post"===t.method||"delete"===t.method){var r;(null===(r=e.authConfig)||void 0===r?void 0:r.nearSignature)&&(t.headers.Authorization="Bearer ".concat(e.authConfig.nearSignature)),t.headers["X-Near-Account"]=e.accountId}return t})}return t=o,e=[{key:"setAuth",value:function(t){this.authConfig=t,this.accountId=t.accountId,t.baseUrl&&(this.client.defaults.baseURL=t.baseUrl)}},{key:"setAccountId",value:function(t){this.accountId=t}},{key:"health",value:function(){var t=this;return s(function(){var e;return l(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.client.get("/health")];case 1:return[2,r.sent().data];case 2:return[2,{status:"error",message:c(e=r.sent(),Error)?e.message:"Unknown error",timestamp:new Date().toISOString()}];case 3:return[2]}})})()}},{key:"isAuthenticated",value:function(){return null!==this.authConfig&&!!this.authConfig.nearSignature&&!!this.accountId}},{key:"clearAuth",value:function(){this.authConfig=null}},{key:"getAccountId",value:function(){return this.accountId}},{key:"getRateLimits",value:function(){var t=this;return s(function(){var e;return l(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.client.get("/api/rate-limits")];case 1:return[2,r.sent().data];case 2:throw e=r.sent(),Error("Failed to get rate limits: ".concat(c(e,Error)?e.message:"Unknown error"));case 3:return[2]}})})()}},{key:"getEndpointRateLimit",value:function(t){var e=this;return s(function(){var r;return l(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.client.get("/api/rate-limits/".concat(encodeURIComponent(t)))];case 1:return[2,n.sent().data];case 2:throw r=n.sent(),Error("Failed to get rate limit for endpoint ".concat(t,": ").concat(c(r,Error)?r.message:"Unknown error"));case 3:return[2]}})})()}},{key:"authorizeNearAccount",value:function(t,e){var r=this;return s(function(){var n;return l(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,r.client.post("/api/auth/authorize-near",{signature:t,accountId:e})];case 1:return[2,a.sent().data];case 2:throw n=a.sent(),Error("Failed to authorize NEAR account: ".concat(c(n,Error)?n.message:"Unknown error"));case 3:return[2]}})})()}},{key:"getNearAuthorizationStatus",value:function(){var t=this;return s(function(){var e;return l(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.client.get("/api/auth/near-status")];case 1:return[2,r.sent().data];case 2:throw e=r.sent(),Error("Failed to get NEAR authorization status: ".concat(c(e,Error)?e.message:"Unknown error"));case 3:return[2]}})})()}},{key:"loginToPlatform",value:function(t,e){var r=this;return s(function(){var n;return l(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,r.client.post("/api/auth/login",{platform:t,credentials:e})];case 1:return[2,a.sent().data];case 2:throw n=a.sent(),Error("Failed to login to platform ".concat(t,": ").concat(c(n,Error)?n.message:"Unknown error"));case 3:return[2]}})})()}},{key:"refreshToken",value:function(){var t=this;return s(function(){var e;return l(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.client.post("/api/auth/refresh")];case 1:return[2,r.sent().data];case 2:throw e=r.sent(),Error("Failed to refresh token: ".concat(c(e,Error)?e.message:"Unknown error"));case 3:return[2]}})})()}},{key:"refreshProfile",value:function(){var t=this;return s(function(){var e;return l(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.client.get("/api/auth/profile")];case 1:return[2,r.sent().data];case 2:throw e=r.sent(),Error("Failed to refresh profile: ".concat(c(e,Error)?e.message:"Unknown error"));case 3:return[2]}})})()}},{key:"getAuthStatus",value:function(){var t=this;return s(function(){var e;return l(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.client.get("/api/auth/status")];case 1:return[2,r.sent().data];case 2:throw e=r.sent(),Error("Failed to get auth status: ".concat(c(e,Error)?e.message:"Unknown error"));case 3:return[2]}})})()}},{key:"revokeAuth",value:function(){var t=this;return s(function(){var e;return l(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.client.post("/api/auth/revoke")];case 1:return[2,r.sent().data];case 2:throw e=r.sent(),Error("Failed to revoke auth: ".concat(c(e,Error)?e.message:"Unknown error"));case 3:return[2]}})})()}},{key:"getConnectedAccounts",value:function(){var t=this;return s(function(){var e;return l(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.client.get("/api/auth/connected-accounts")];case 1:return[2,r.sent().data];case 2:throw e=r.sent(),Error("Failed to get connected accounts: ".concat(c(e,Error)?e.message:"Unknown error"));case 3:return[2]}})})()}},{key:"createPost",value:function(t){var e=this;return s(function(){var r;return l(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.client.post("/api/posts",t)];case 1:return[2,n.sent().data];case 2:throw r=n.sent(),Error("Failed to create post: ".concat(c(r,Error)?r.message:"Unknown error"));case 3:return[2]}})})()}},{key:"repost",value:function(t){var e=this;return s(function(){var r;return l(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.client.post("/api/posts/repost",t)];case 1:return[2,n.sent().data];case 2:throw r=n.sent(),Error("Failed to repost: ".concat(c(r,Error)?r.message:"Unknown error"));case 3:return[2]}})})()}},{key:"quotePost",value:function(t){var e=this;return s(function(){var r;return l(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.client.post("/api/posts/quote",t)];case 1:return[2,n.sent().data];case 2:throw r=n.sent(),Error("Failed to quote post: ".concat(c(r,Error)?r.message:"Unknown error"));case 3:return[2]}})})()}},{key:"replyToPost",value:function(t){var e=this;return s(function(){var r;return l(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.client.post("/api/posts/reply",t)];case 1:return[2,n.sent().data];case 2:throw r=n.sent(),Error("Failed to reply to post: ".concat(c(r,Error)?r.message:"Unknown error"));case 3:return[2]}})})()}},{key:"likePost",value:function(t){var e=this;return s(function(){var r;return l(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.client.post("/api/posts/like",t)];case 1:return[2,n.sent().data];case 2:throw r=n.sent(),Error("Failed to like post: ".concat(c(r,Error)?r.message:"Unknown error"));case 3:return[2]}})})()}},{key:"unlikePost",value:function(t){var e=this;return s(function(){var r;return l(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.client.post("/api/posts/unlike",t)];case 1:return[2,n.sent().data];case 2:throw r=n.sent(),Error("Failed to unlike post: ".concat(c(r,Error)?r.message:"Unknown error"));case 3:return[2]}})})()}},{key:"deletePost",value:function(t){var e=this;return s(function(){var r;return l(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e.client.delete("/api/posts",{data:t})];case 1:return[2,n.sent().data];case 2:throw r=n.sent(),Error("Failed to delete post: ".concat(c(r,Error)?r.message:"Unknown error"));case 3:return[2]}})})()}},{key:"getLeaderboard",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"weekly",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=this;return s(function(){var n;return l(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,r.client.get("/api/activity/leaderboard",{params:{period:t,limit:e}})];case 1:return[2,a.sent().data];case 2:throw n=a.sent(),Error("Failed to get leaderboard: ".concat(c(n,Error)?n.message:"Unknown error"));case 3:return[2]}})})()}},{key:"getAccountActivity",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;return s(function(){var n;return l(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,r.client.get("/api/activity/account/".concat(t),{params:e})];case 1:return[2,a.sent().data];case 2:throw n=a.sent(),Error("Failed to get account activity: ".concat(c(n,Error)?n.message:"Unknown error"));case 3:return[2]}})})()}},{key:"getAccountPosts",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;return s(function(){var n;return l(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,r.client.get("/api/activity/account/".concat(t,"/posts"),{params:e})];case 1:return[2,a.sent().data];case 2:throw n=a.sent(),Error("Failed to get account posts: ".concat(c(n,Error)?n.message:"Unknown error"));case 3:return[2]}})})()}},{key:"normalizeMedia",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;return s(function(){var n,o,s,i,u,h,f,d,p,v,g,y,m,b,w,k,E,U,C,P,A;return l(this,function(l){switch(l.label){case 0:o=void 0===(n=e.maxSize)?10485760:n,i=void 0===(s=e.allowedTypes)?["image/jpeg","image/png","image/gif","image/webp","video/mp4","video/webm","audio/mp3","audio/wav"]:s,u=e.quality,d=void 0===(f=e.thumbnailSize)?{width:300,height:300}:f,l.label=1;case 1:var h,O;if(l.trys.push([1,17,,18]),y={},"string"!=typeof t)return[3,7];if(!t.startsWith("data:"))return[3,2];return h=t.split(","),O=2,w=(b=function(t){if(Array.isArray(t))return t}(h)||function(t,e){var r,n,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var o=[],s=!0,i=!1;try{for(a=a.call(t);!(s=(r=a.next()).done)&&(o.push(r.value),!e||o.length!==e);s=!0);}catch(t){i=!0,n=t}finally{try{!s&&null!=a.return&&a.return()}finally{if(i)throw n}}return o}}(h,O)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if("Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}}(h,O)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],k=b[1],v=(null===(m=w.match(/data:([^;]+)/))||void 0===m?void 0:m[1])||"application/octet-stream",p=k,g=Math.floor(.75*k.length),[3,6];case 2:return[4,fetch(t)];case 3:return[4,l.sent().blob()];case 4:return v=(E=l.sent()).type,g=E.size,[4,r.blobToBase64(E)];case 5:p=l.sent(),l.label=6;case 6:return[3,12];case 7:if(!(c(t,Blob)||c(t,File)))return[3,9];return v=t.type,g=t.size,[4,r.blobToBase64(t)];case 8:return p=l.sent(),c(t,File)&&(y.originalName=t.name),[3,12];case 9:if(!c(t,ArrayBuffer))return[3,11];return v=(U=new Blob([t])).type,g=U.size,[4,r.blobToBase64(U)];case 10:return p=l.sent(),[3,12];case 11:throw Error("Unsupported media type");case 12:if(g>o)throw Error("Media size (".concat(g," bytes) exceeds maximum allowed size (").concat(o," bytes)"));if(!i.includes(v))throw Error("Media type ".concat(v," is not allowed"));if(!("image"==(C=v.startsWith("image/")?"image":v.startsWith("video/")?"video":v.startsWith("audio/")?"audio":"document")||"video"===C))return[3,16];l.label=13;case 13:return l.trys.push([13,15,,16]),[4,r.generateThumbnail(p,v,d)];case 14:return P=l.sent(),[3,16];case 15:return console.warn("Failed to generate thumbnail:",l.sent()),[3,16];case 16:return[2,{type:C,data:p,mimeType:v,size:g,thumbnail:P,metadata:y}];case 17:throw A=l.sent(),Error("Failed to normalize media: ".concat(c(A,Error)?A.message:"Unknown error"));case 18:return[2]}})})()}},{key:"blobToBase64",value:function(t){return s(function(){return l(this,function(e){return[2,new Promise(function(e,r){var n=new FileReader;n.onload=function(){e(n.result.split(",")[1])},n.onerror=r,n.readAsDataURL(t)})]})})()}},{key:"generateThumbnail",value:function(t,e,r){return s(function(){return l(this,function(n){return[2,new Promise(function(n,a){var o=new Image;o.onload=function(){var t=document.createElement("canvas"),e=t.getContext("2d");if(!e){a(Error("Failed to get canvas context"));return}var s=o.width/o.height,i=r.width,u=r.height;s>1?u=i/s:i=u*s,t.width=i,t.height=u,e.drawImage(o,0,0,i,u),n(t.toDataURL("image/jpeg",.8).split(",")[1])},o.onerror=function(){return a(Error("Failed to load image for thumbnail"))},o.src="data:".concat(e,";base64,").concat(t)})]})})()}},{key:"createRequestWithOverrides",value:function(t){var e=this,r=n.default.create({baseURL:this.client.defaults.baseURL,timeout:(null==t?void 0:t.timeout)||this.client.defaults.timeout,headers:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){u(t,e,r[e])})}return t}({},this.client.defaults.headers,null==t?void 0:t.headers)});return r.interceptors.request.use(function(r){if("get"===r.method&&(r.headers["X-Near-Account"]=(null==t?void 0:t.accountId)||e.accountId),"post"===r.method||"delete"===r.method){var n;(null==t?void 0:t.authToken)?r.headers.Authorization="Bearer ".concat(t.authToken):(null===(n=e.authConfig)||void 0===n?void 0:n.nearSignature)&&(r.headers.Authorization="Bearer ".concat(e.authConfig.nearSignature)),r.headers["X-Near-Account"]=(null==t?void 0:t.accountId)||e.accountId}return r}),r}},{key:"mapError",value:function(t){var e,r=new Date().toISOString();if(t.response){var n,a=t.response,o=a.status,s=a.data;return{code:(null==s?void 0:s.code)||"HTTP_".concat(o),message:(null==s?void 0:s.message)||t.message||"HTTP ".concat(o," Error"),details:(null==s?void 0:s.details)||{status:o,url:null===(n=t.config)||void 0===n?void 0:n.url},statusCode:o,timestamp:r}}if(t.request)return{code:"NETWORK_ERROR",message:"Network request failed",details:{url:null===(e=t.config)||void 0===e?void 0:e.url},timestamp:r};return{code:"UNKNOWN_ERROR",message:t.message||"Unknown error occurred",timestamp:r}}},{key:"executeRequest",value:function(t,e){var r=this;return s(function(){var n;return l(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,t(e?r.createRequestWithOverrides(e):r.client)];case 1:return[2,a.sent().data];case 2:throw n=a.sent(),r.mapError(n);case 3:return[2]}})})()}},{key:"healthWithOverrides",value:function(t){var e=this;return s(function(){return l(this,function(r){return[2,e.executeRequest(function(t){return t.get("/health")},t)]})})()}},{key:"createPostWithOverrides",value:function(t,e){var r=this;return s(function(){return l(this,function(n){return[2,r.executeRequest(function(e){return e.post("/api/posts",t)},e)]})})()}},{key:"getRateLimitsWithOverrides",value:function(t){var e=this;return s(function(){return l(this,function(r){return[2,e.executeRequest(function(t){return t.get("/api/rate-limits")},t)]})})()}}],i(t.prototype,e),r&&i(t,r),o}()},7163:function(t,e,r){"use strict";r.r(e),r.d(e,{CrosspostPluginClient:function(){return n.CrosspostPluginClient},default:function(){return s},initializePlugin:function(){return o},pluginConfig:function(){return a}});var n=r("9223"),a={name:"crosspost-plugin",version:"1.0.0",description:"Crosspost plugin for content distribution"};function o(t){var e=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){var n,a,o;n=t,a=e,o=r[e],a in n?Object.defineProperty(n,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[a]=o})}return t}({},a,t);return console.log("Initializing ".concat(e.name," v").concat(e.version)),new CrosspostPluginClient}var s={CrosspostPluginClient:CrosspostPluginClient,initializePlugin:o,pluginConfig:a}}}]);
//# sourceMappingURL=src_index_ts.js.map